{
    import "Systemd";
    include "testsuite.ycp";


    DUMP("Systemd::Running() tests");

    // Note: \0 should be used here as the separator, but YCP does not allows that...

    // test standard System V init
    TEST (``(Systemd::Running()), [$[
	    "target" : $[ "string" : "init [5]\n" ]
	    ], $[], $[]], nil);

    // systemd
    TEST (``(Systemd::Running()), [$[
	    "target" : $[ "string" : "/bin/systemd\n" ]
	    ], $[], $[]], nil);

    DUMP("Systemd::SetDefaultRunlevel() tests");

    // test invalid parameters
    TEST (``(Systemd::SetDefaultRunlevel(nil)), [$[], $[], $[
	    "target" : $[ "bash" : 0 ]
	    ]], nil);

    TEST (``(Systemd::SetDefaultRunlevel(-1)), [$[], $[], $[
	    "target" : $[ "bash" : 0 ]
	    ]], nil);

    TEST (``(Systemd::SetDefaultRunlevel(7)), [$[], $[], $[
	    "target" : $[ "bash" : 0 ]
	    ]], nil);

    // test valid parameters
    TEST (``(Systemd::SetDefaultRunlevel(3)), [$[], $[], $[
	    "target" : $[ "bash" : 0 ]
	    ]], nil);

    TEST (``(Systemd::SetDefaultRunlevel(5)), [$[], $[], $[
	    "target" : $[ "bash" : 0 ]
	    ]], nil);

    // test failure
    TEST (``(Systemd::SetDefaultRunlevel(5)), [$[], $[], $[
	    "target" : $[ "bash" : 1 ]
	    ]], nil);


    DUMP("Systemd::DefaultRunlevel() tests");

    // test missing / invalid (not a symlink) default
    TEST (``(Systemd::DefaultRunlevel()), [$[ "target" : $[ "symlink" : nil]], $[], $[]], nil);

    // test numeric runlevel
    TEST (``(Systemd::DefaultRunlevel()), [$[ "target" : $[ "symlink" : "/lib/systemd/system/runlevel3.target"]], $[], $[]], nil);

    // test symbolic runlevel
    TEST (``(Systemd::DefaultRunlevel()), [$[ "target" : $[ "symlink" : "/lib/systemd/system/graphical.target"]], $[], $[]], nil);

    // test unknown symbolic runlevel
    TEST (``(Systemd::DefaultRunlevel()), [$[ "target" : $[ "symlink" : "/lib/systemd/system/unknown_default.target"]], $[], $[]], nil);
}
